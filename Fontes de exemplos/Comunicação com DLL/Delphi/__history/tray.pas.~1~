unit tray;

interface
  Function CreateTrayIcon(hint:string):boolean;
  procedure DestroyTrayIcon;

implementation

uses  Windows,
      Graphics,
      CoolTrayIcon;

Var TrayIcon1:TCoolTrayicon;
    Icon1:TIcon;

Function CreateTrayIcon(hint:string):boolean;
begin
try
  Icon1:=TIcon.Create;
  Icon1.Handle:=LoadIcon(hInstance,'MAIN');
  TrayIcon1:=TCoolTrayIcon.Create(nil);
  TrayIcon1.FreeOnRelease;
  TrayIcon1.Hint:=hint;
  TrayIcon1.Icon:=Icon1;
  TrayIcon1.IconVisible:=true;
  result:=true;
except
  result:=false;
end;
end;


procedure DestroyTrayIcon;
begin
Trayicon1.Destroy;
end;


end.
